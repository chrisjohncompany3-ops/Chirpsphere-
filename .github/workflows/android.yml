name: Android CI

on:
  push:
      branches:
            - main
              pull_request:

              jobs:
                build:
                    runs-on: ubuntu-latest

                        steps:
                              # Checkout repo
                                    - name: Checkout
                                            uses: actions/checkout@v3

                                                  # Set up JDK
                                                        - name: Set up JDK 11
                                                                uses: actions/setup-java@v3
                                                                        with:
                                                                                  java-version: '11'
                                                                                            distribution: 'temurin'

                                                                                                  # Cache Gradle
                                                                                                        - name: Cache Gradle
                                                                                                                uses: actions/cache@v3
                                                                                                                        with:
                                                                                                                                  path: |
                                                                                                                                              ~/.gradle/caches
                                                                                                                                                          ~/.gradle/wrapper
                                                                                                                                                                    key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
                                                                                                                                                                              restore-keys: |
                                                                                                                                                                                          ${{ runner.os }}-gradle-

                                                                                                                                                                                                # Build debug APK
                                                                                                                                                                                                      - name: Build with Gradle
                                                                                                                                                                                                              run: ./gradlew assembleDebug --stacktrace

                                                                                                                                                                                                                    # Upload APK as artifact
                                                                                                                                                                                                                          - name: Upload APK
                                                                                                                                                                                                                                  uses: actions/upload-artifact@v3
                                                                                                                                                                                                                                          with:
                                                                                                                                                                                                                                                    name: Chirpsphere-debug-apk
                                                                                                                                                                                                                                                              path: app/build/outputs/apk/debug/app-debug.apk